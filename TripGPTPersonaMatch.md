# TripGPT Persona Match - Roadmap

## ðŸŽ¯ **Goal:** Evolve TripWell into a dynamic, learning persona system that adapts based on user choices and behavior, starting with a hybrid MVP 1 approach.

---

## ðŸš€ **The 6-Step Plan (Updated UX Flow):**

### **Step 1: Meta Selection - `TripMetaSelect.jsx` (First - Clear the Obvious)**
- **Objective:** Clear out the obvious tourist attractions first for better UX.
- **Changes:**
    - **Create:** `TripMetaSelect.jsx`
    - **Display:** Meta attractions generated by the backend (`/tripwell/meta-attractions`).
    - **User Interaction:** Checkboxes for users to select which meta attractions they *want* to include in their trip.
    - **UX Logic:** "Hey bro - we know you're going to Paris, just pick what you want to do there"
    - **No learning/weight modification** at this stage; purely for trip planning integration.
    - **Save selections for later** - not part of persona learning.

### **Step 2: Persona Learning - `TripPersonaSample.jsx` (Second - Learn Preferences)**
- **Objective:** Present a curated sample of attractions/restaurants/neat things, and use user selections to dynamically adjust persona weights via OpenAI.
- **Changes:**
    - **Create:** `TripPersonaSample.jsx`
    - **Display:**
        - 2 attractions (tagged by persona)
        - 2 restaurants (tagged by persona)
        - 2 neat things (not meta, tagged by persona)
    - **User Interaction:** User selects which samples they like.
    - **UX Logic:** "Hey bro - we got ya, here's some other things you may like - give us your feedback before we go build the final boss"
    - **Create:** `TripPersonaSampleService.js` (Backend Service)
        - **Input:** User's sample selections, current `TripPersona` weights.
        - **OpenAI Call:** Prompt OpenAI to analyze user choices and suggest updated persona weights (e.g., `{ art: X, foodie: Y, adventure: Z, history: W }`).
        - **Output:** New persona weights.
        - **Update:** Save new weights back to `TripPersona` model.

### **Step 3: Frontend Refactor - `TripIntentForm.jsx`**
- **Objective:** Slim down the user input form to focus on core preferences, removing unnecessary complexity.
- **Changes:**
    - **Remove:** `vibes`, `mobility`, `travelPace` sections.
    - **Simplify "Priorities"** to a single selection from the 4 core personas (Art, Foodie, Adventure, History) using radio buttons.
    - **Simplify "Budget"** to radio buttons (Low, Moderate, High).
    - **Simplify "Who With"** to radio buttons (Solo, Couple, Family, Friends).
    - **Add new input fields:**
        - "Romance Level" (e.g., slider 0-100)
        - "Caretaker Role" (e.g., slider 0-100, representing responsibility for others)
        - "Flexibility" (e.g., slider 0-100, representing free/spontaneous vs. locked/rigid)
    - **Frontend does NOT handle weights directly.** It sends simple selections to the backend.

### **Step 4: Backend Model Refactor - `TripIntent.js` â†’ `TripPersona.js`**
- **Objective:** Create a new Mongoose model to store the weighted persona and other trip-specific factors.
- **Changes:**
    - **Rename/Refactor:** `TripIntent.js` to `TripPersona.js`.
    - **Schema:**
        - `tripId`: Reference to `TripBase`
        - `userId`: Reference to `User`
        - `personas`: Object with weights (e.g., `{ art: 0.6, foodie: 0.1, adventure: 0.1, history: 0.1 }`)
        - `budget`: String (low, moderate, high)
        - `romanceLevel`: Number (0.0 - 1.0)
        - `caretakerRole`: Number (0.0 - 1.0)
        - `flexibility`: Number (0.0 - 1.0)
        - `whoWith`: String (solo, couple, family, friends)
    - **Default Weights Logic (Backend):**
        - When user selects a primary persona (e.g., "Art"), set its weight to `0.6`.
        - Set other persona weights to `0.1`.
        - Budget, Romance, Caretaker, Flexibility will have their own initial values/weights based on user input.

### **Step 5: Refine Itinerary Build - `buildListRoute.js` & `itineraryGPTService.js`**
- **Objective:** Integrate the new persona weights and selected meta attractions into the final itinerary generation.
- **Changes:**
    - **Modify `buildListRoute.js`:**
        - Fetch `TripPersona` weights.
        - Fetch selected meta attractions (from `TripMetaSelect` step).
        - Pass these to the GPT service.
    - **Modify `itineraryGPTService.js` (or similar GPT service):**
        - **Prompt Engineering:** Include persona weights and selected meta attractions in the GPT prompt.
        - **"Why" Explanation:** Instruct GPT to explain *why* each recommendation was chosen, based on persona and meta avoidance.
        - **Algo Style:** Request a structured output for each day (e.g., "Restaurant, To Do, To See").
        - **Integration:** Prioritize selected meta attractions, then fill remaining slots with personalized content based on persona weights.

### **Step 6: Data Collection & Python Analysis (Future)**
- **Objective:** Establish a feedback loop to refine persona weights based on real user behavior, eventually moving beyond OpenAI for weight definition.
- **Changes:**
    - **Implement Data Collection:** Log all user choices (initial preferences, meta selections, sample selections).
    - **Develop Python Service:**
        - Analyze collected data.
        - Identify patterns in user behavior.
        - Develop algorithms to define and adjust persona weights more accurately.
        - **Goal:** Eventually replace the OpenAI `TripPersonaSampleService` with a data-driven Python "brain."

---

## ðŸŽ¯ **Key Benefits of this Hybrid Approach:**

- **MVP 1 Focus:** Get a functional, intelligent system out the door quickly using OpenAI's "big brain."
- **Data-Driven Evolution:** Lay the groundwork for collecting real user data to build a more sophisticated, custom AI.
- **Predictability:** Start with clear persona definitions and conditional logic.
- **Cost Optimization:** Leverage OpenAI for initial intelligence, then transition to more efficient, custom algorithms.
- **User Engagement:** Offer meaningful choices (meta selection, samples) that directly influence their trip.
- **Better UX Flow:** Clear obvious stuff first, learn preferences second, build final trip last.
